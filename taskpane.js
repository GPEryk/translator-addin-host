/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,n,t){"use strict";e.exports=t.p+"26dac32e4c8b7c248fe6.css"},60947:function(e,n,t){"use strict";e.exports=t.p+"2927fb4829fc176b7062.js"},98362:function(e,n,t){"use strict";e.exports=t.p+"assets/logo-filled.png"}},n={};function t(r){var a=n[r];if(void 0!==a)return a.exports;var o=n[r]={exports:{}};return e[r](o,o.exports,t),o.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var r=n.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(n){if(null!=n){var t=n["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length))return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}}}throw new TypeError(e(n)+" is not iterable")}function t(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o,c,i=[],u=!0,s=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=o.call(t)).done)&&(i.push(r.value),i.length!==n);u=!0);}catch(e){s=!0,a=e}finally{try{if(!u&&null!=t.return&&(c=t.return(),Object(c)!==c))return}finally{if(s)throw a}}return i}}(e,n)||i(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach(function(n){o(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function o(n,t,r){return(t=function(n){var t=function(n){if("object"!=e(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var r=t.call(n,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function c(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=i(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,u=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return c=e.done,e},e:function(e){u=!0,o=e},f:function(){try{c||null==t.return||t.return()}finally{if(u)throw o}}}}function i(e,n){if(e){if("string"==typeof e)return u(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?u(e,n):void 0}}function u(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function s(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function o(t,r,a,o){var u=r&&r.prototype instanceof i?r:i,s=Object.create(u.prototype);return l(s,"_invoke",function(t,r,a){var o,i,u,s=0,l=a||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(n,t){return o=n,i=0,u=e,p.n=t,c}};function d(t,r){for(i=t,u=r,n=0;!f&&s&&!a&&n<l.length;n++){var a,o=l[n],d=p.p,g=o[2];t>3?(a=g===r)&&(u=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=d&&((a=t<2&&d<o[1])?(i=0,p.v=r,p.n=o[1]):d<g&&(a=t<3||o[0]>r||r>g)&&(o[4]=t,o[5]=r,p.n=g,i=0))}if(a||t>1)return c;throw f=!0,r}return function(a,l,g){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,g),i=l,u=g;(n=i<2?e:u)||!f;){o||(i?i<3?(i>1&&(p.n=-1),d(i,u)):p.n=u:p.v=u);try{if(s=2,o){if(i||(a="next"),n=o[a]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,i<2&&(i=0)}else 1===i&&(n=o.return)&&n.call(o),i<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=e}else if((n=(f=p.n<0)?u:t.call(r,p))!==c)break}catch(n){o=e,i=1,u=n}finally{s=1}}return{value:n,done:f}}}(t,a,o),!0),s}var c={};function i(){}function u(){}function f(){}n=Object.getPrototypeOf;var p=[][r]?n(n([][r]())):(l(n={},r,function(){return this}),n),d=f.prototype=i.prototype=Object.create(p);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return u.prototype=f,l(d,"constructor",f),l(f,"constructor",u),u.displayName="GeneratorFunction",l(f,a,"GeneratorFunction"),l(d),l(d,a,"Generator"),l(d,r,function(){return this}),l(d,"toString",function(){return"[object Generator]"}),(s=function(){return{w:o,m:g}})()}function l(e,n,t,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}l=function(e,n,t,r){function o(n,t){l(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},l(e,n,t,r)}function f(e,n,t,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void t(e)}i.done?n(u):Promise.resolve(u).then(r,a)}function p(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var o=e.apply(n,t);function c(e){f(o,r,a,c,i,"next",e)}function i(e){f(o,r,a,c,i,"throw",e)}c(void 0)})}}var d="https://corsproxy.io/?"+encodeURIComponent("https://api.openai.com/v1/chat/completions"),g=null,m=null,y=[],h=[];function v(e){return new Promise(function(n){var t=document.getElementById("alertModal"),r=document.getElementById("alertMessage"),a=document.getElementById("alertOk");r.textContent=e,t.classList.remove("hidden"),a.onclick=function(){return t.classList.add("hidden"),a.onclick=null,void n()}})}function b(e){return new Promise(function(n){var t=document.getElementById("confirmModal"),r=document.getElementById("confirmMessage"),a=document.getElementById("confirmYes"),o=document.getElementById("confirmNo");r.textContent=e,t.classList.remove("hidden");var c=function(e){t.classList.add("hidden"),a.onclick=null,o.onclick=null,n(e)};a.onclick=function(){return c(!0)},o.onclick=function(){return c(!1)}})}function k(){try{if("undefined"!=typeof Office&&Office.context&&Office.context.roamingSettings)return Office.context.roamingSettings.get("openai_api_key")||""}catch(e){console.log("roamingSettings not available, using localStorage")}try{return localStorage.getItem("openai_api_key")||""}catch(e){return console.error("Storage not available:",e),""}}function w(){return z.apply(this,arguments)}function z(){return(z=p(s().m(function e(){var n,t,r;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=document.getElementById("apiKeyInput"),t=n.value.trim()){e.n=2;break}return e.n=1,v("Wklej sw√≥j klucz API!");case 1:return e.a(2);case 2:if(t.startsWith("sk-")){e.n=4;break}return e.n=3,v("Klucz API powinien zaczynaƒá siƒô od 'sk-'");case 3:return e.a(2);case 4:e.p=4,"undefined"!=typeof Office&&Office.context&&Office.context.roamingSettings?(Office.context.roamingSettings.set("openai_api_key",t),Office.context.roamingSettings.saveAsync(function(e){e.status===Office.AsyncResultStatus.Succeeded?O("‚úÖ Klucz API zapisany!"):O("‚ö†Ô∏è B≈ÇƒÖd zapisu: "+e.error.message)})):(localStorage.setItem("openai_api_key",t),O("‚úÖ Klucz API zapisany (localStorage)!")),n.value="",n.type="password",I(),e.n=7;break;case 5:return e.p=5,r=e.v,e.n=6,v("B≈ÇƒÖd zapisu klucza: "+r.message);case 6:console.error(r);case 7:return e.a(2)}},e,null,[[4,5]])}))).apply(this,arguments)}function E(){return S.apply(this,arguments)}function S(){return(S=p(s().m(function e(){var n;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,b("Czy na pewno chcesz usunƒÖƒá zapisany klucz API?");case 1:if(!e.v){e.n=5;break}e.p=2,"undefined"!=typeof Office&&Office.context&&Office.context.roamingSettings&&(Office.context.roamingSettings.remove("openai_api_key"),Office.context.roamingSettings.saveAsync()),localStorage.removeItem("openai_api_key"),document.getElementById("apiKeyInput").value="",I(),O("üóëÔ∏è Klucz API usuniƒôty"),e.n=5;break;case 3:return e.p=3,n=e.v,e.n=4,v("B≈ÇƒÖd usuwania klucza: "+n.message);case 4:console.error(n);case 5:return e.a(2)}},e,null,[[2,3]])}))).apply(this,arguments)}function I(){var e=document.getElementById("apiKeyStatus"),n=k();if(n){var t=n.substring(0,10)+"..."+n.substring(n.length-4);e.innerHTML="‚úÖ Klucz zapisany: <code>".concat(t,'</code> | <a href="https://platform.openai.com/api-keys" target="_blank">Zmie≈Ñ klucz</a>'),e.style.color="#10a37f"}else e.innerHTML='‚ö†Ô∏è Brak klucza API! <a href="https://platform.openai.com/api-keys" target="_blank">Uzyskaj klucz tutaj</a>',e.style.color="#ff6b6b"}function O(e){var n=document.getElementById("log");n&&(n.textContent+=e+"\n",n.scrollTop=n.scrollHeight)}function j(e){var n=document.getElementById("progress"),t=document.getElementById("progressBar");n&&t&&(null!=e?(n.classList.remove("hidden"),t.style.width="".concat(e,"%")):n.classList.add("hidden"))}function B(){var e=document.getElementById("gLangSelect"),n=document.getElementById("sourceLangSelect").value||"EN";e.innerHTML="";var t="PL"===n?h:y,r="PL"===n?"PL-XX":"EN-XX";if(!t.length){var a=document.createElement("option");return a.value="",a.textContent="(brak arkuszy ".concat(r,")"),void e.appendChild(a)}var o=document.createElement("option");o.value="",o.textContent="Wszystkie jƒôzyki",e.appendChild(o);var i,u=c(t);try{for(u.s();!(i=u.n()).done;){var s=i.value,l=document.createElement("option");l.value=s,l.textContent=s,e.appendChild(l)}}catch(e){u.e(e)}finally{u.f()}}function x(){return L.apply(this,arguments)}function L(){return L=p(s().m(function e(){var n,r;return s().w(function(e){for(;;)switch(e.n){case 0:if(k()){e.n=2;break}return e.n=1,v("‚ö†Ô∏è Najpierw zapisz sw√≥j klucz OpenAI API w sekcji Konfiguracja!");case 1:case 4:return e.a(2);case 2:if(n=document.getElementById("skipFilled").checked,r=document.getElementById("sourceLangSelect").value||"EN",g){e.n=3;break}return e.n=3,A();case 3:return O("Czytam zaznaczenie... (≈∫r√≥d≈Ço: ".concat(r,")")),e.n=4,Excel.run(function(){var e=p(s().m(function e(o){var i,u,l,f,p,d,y,h,v,b,k,w,z,E,S,I,B,x,L,P,A,N,R,T,U,_,D,M,K,G,W,Z,X,Y,J,q,Q,V,ee,ne,te;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return i=o.workbook.worksheets.getActiveWorksheet(),(u=o.workbook.getSelectedRange()).load(["rowCount","columnCount","rowIndex","columnIndex"]),e.n=1,o.sync();case 1:return(l=i.getUsedRange()).load("columnCount"),e.n=2,o.sync();case 2:return(f=i.getRangeByIndexes(0,0,1,l.columnCount)).load("values"),e.n=3,o.sync();case 3:if(p=f.values[0].map(function(e){return $(e)}),!((d=p.indexOf(r))<0)){e.n=4;break}return O("B≈ÅƒÑD: brak kolumny ".concat(r," w wierszu nag≈Ç√≥wk√≥w (1).")),e.a(2);case 4:for(y="PL"===r?m:g,h=[],v=0;v<u.rowCount;v++)for(b=0;b<u.columnCount;b++)k=u.rowIndex+v,w=u.columnIndex+b,z=p[w],E=i.getCell(k,d),S=i.getCell(k,w),E.load("values"),S.load("values"),h.push({absRow:k,absCol:w,tgtLang:z,srcCell:E,tgtCell:S});return e.n=5,o.sync();case 5:I=new Map,B=0,x=h;case 6:if(!(B<x.length)){e.n=11;break}if(L=x[B],P=(L.srcCell.values[0][0]||"").toString().trim(),A=(L.tgtCell.values[0][0]||"").toString().trim(),P){e.n=7;break}return e.a(3,10);case 7:if(!n||!A){e.n=8;break}return e.a(3,10);case 8:if(L.tgtLang!==r){e.n=9;break}return e.a(3,10);case 9:I.has(L.tgtLang)||I.set(L.tgtLang,[]),I.get(L.tgtLang).push(a(a({},L),{},{src:P}));case 10:B++,e.n=6;break;case 11:N=0,R=c(I.values());try{for(R.s();!(T=R.n()).done;)U=T.value,N+=U.length}catch(e){R.e(e)}finally{R.f()}if(0!==N){e.n=12;break}return O("Brak danych do t≈Çumaczenia."),e.a(2);case 12:_=0,D=c(I.entries()),e.p=13,D.s();case 14:if((M=D.n()).done){e.n=21;break}if(K=t(M.value,2),G=K[0],W=K[1],G){e.n=15;break}return e.a(3,20);case 15:O("".concat(r," ‚Üí ").concat(G,": ").concat(W.length," rekord√≥w")),Z=0;case 16:if(!(Z<W.length)){e.n=20;break}return X=W.slice(Z,Z+80),Y=X.map(function(e){return e.src}),J=F(Y,G,y),q=J.tokenizedLines,Q=J.tokenMap,O("  batch ".concat(Math.floor(Z/80)+1,": wysy≈Çam ").concat(Y.length," linii")),e.n=17,C(G,q,r);case 17:for(V=e.v,ee=0;ee<X.length;ee++)ne=H(V[ee]||"",Q),i.getCell(X[ee].absRow,X[ee].absCol).values=[[ne]];return e.n=18,o.sync();case 18:_+=X.length,j(Math.round(_/N*100));case 19:Z+=80,e.n=16;break;case 20:e.n=14;break;case 21:e.n=23;break;case 22:e.p=22,te=e.v,D.e(te);case 23:return e.p=23,D.f(),e.f(23);case 24:j(null),O("Gotowe.");case 25:return e.a(2)}},e,null,[[13,22,23,24]])}));return function(n){return e.apply(this,arguments)}}())}},e)})),L.apply(this,arguments)}function C(e,n){return P.apply(this,arguments)}function P(){return P=p(s().m(function e(n,t){var r,a,o,c,i,u,l,f,p,g,m=arguments;return s().w(function(e){for(;;)switch(e.n){case 0:if(o="You are translating product names from ".concat("PL"===(a=m.length>2&&void 0!==m[2]?m[2]:"EN")?"Polish":"English",". Keep meaning 1:1. Preserve brands, model codes, numbers, units, punctuation, and casing. Do not add marketing words. Do not paraphrase. Return one translation per line in the same order. Output only translations. Do NOT translate or alter tokens like [[G1]], [[G2]]; keep them exactly."),c="Translate from ".concat(a," to ").concat(n,"\nTexts (one per line):\n")+t.join("\n"),i={model:"gpt-4o-mini",messages:[{role:"system",content:o},{role:"user",content:c}],max_tokens:2e3,temperature:.3},u=k()){e.n=1;break}throw new Error("Brak klucza API! Dodaj klucz w sekcji Konfiguracja.");case 1:return e.n=2,fetch(d,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(u)},body:JSON.stringify(i)});case 2:if((l=e.v).ok){e.n=4;break}return e.n=3,l.text();case 3:throw f=e.v,new Error("OpenAI API error: ".concat(l.status," - ").concat(f));case 4:return e.n=5,l.json();case 5:return p=e.v,g=(null===(r=p.choices)||void 0===r||null===(r=r[0])||void 0===r||null===(r=r.message)||void 0===r?void 0:r.content)||"",e.a(2,g.split(/\r?\n/))}},e)})),P.apply(this,arguments)}function A(){return N.apply(this,arguments)}function N(){return(N=p(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,D();case 1:B(),W();case 2:return e.a(2)}},e)}))).apply(this,arguments)}function R(){return T.apply(this,arguments)}function T(){return T=p(s().m(function e(){var n;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return O("Otwieranie arkuszy glosariuszy..."),e.p=1,e.n=2,Excel.run(function(){var e=p(s().m(function e(n){var t,r,a;return s().w(function(e){for(;;)switch(e.n){case 0:return(t=n.workbook.worksheets).load("items/name"),e.n=1,n.sync();case 1:if(0!==(r=t.items.filter(function(e){var n=e.name.toUpperCase();return(n.startsWith("EN-")||n.startsWith("PL-"))&&n.length>=5})).length){e.n=2;break}return O("‚ö†Ô∏è Nie znaleziono arkuszy glosariuszy (EN-PL, PL-EN, EN-DE, itp.)"),O("Stw√≥rz je najpierw u≈ºywajƒÖc 'Dodaj/zaktualizuj parƒô' lub 'Za≈Çaduj podstawowy glosariusz'"),e.a(2);case 2:return r[0].activate(),e.n=3,n.sync();case 3:a=r.map(function(e){return e.name}).join(", "),O("‚úÖ Znaleziono arkusze: ".concat(a)),O("üìã Aktywowano: ".concat(r[0].name)),O("üí° Mo≈ºesz prze≈ÇƒÖczaƒá siƒô miƒôdzy arkuszami u≈ºywajƒÖc zak≈Çadek na dole Excela");case 4:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:e.p=3,n=e.v,O("‚ùå B≈ÇƒÖd: ".concat(n.message)),console.error(n);case 4:return e.a(2)}},e,null,[[1,3]])})),T.apply(this,arguments)}function U(){return _.apply(this,arguments)}function _(){return _=p(s().m(function e(){var t,r,a,o,i;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,b("Czy za≈Çadowaƒá podstawowy glosariusz?\n\nTo doda terminy techniczne do arkuszy:\n‚Ä¢ EN ‚Üí PL, DE, FR, ES, IT, RO, UA, RU\n‚Ä¢ PL ‚Üí EN (t≈Çumaczenie polsko-angielskie)");case 1:if(e.v){e.n=2;break}return e.a(2);case 2:return O("≈Åadowanie podstawowego glosariusza..."),e.p=3,t=(new Date).getTime(),e.n=4,fetch("https://gperyk.github.io/translator-addin-host/glossary/basic-glossary.json?t=".concat(t));case 4:if((r=e.v).ok){e.n=5;break}throw new Error("HTTP error! status: ".concat(r.status));case 5:return e.n=6,r.json();case 6:if((a=e.v)&&a.terms){e.n=7;break}throw new Error("Nieprawid≈Çowa struktura danych glosariusza. Spr√≥buj ponownie za chwilƒô.");case 7:return o=0,e.n=8,Excel.run(function(){var e=p(s().m(function e(t){var r,i,u,l,f,p,d,g,m,y,h,v,b,k,w,z,E,S,I,j;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return(r=t.workbook.worksheets).load("items/name"),e.n=1,t.sync();case 1:i=a.terms,u=["pl","de","fr","es","it","ro","ua","ru"],l=s().m(function e(){var n,a,u,l,d,g,m,y,h,v,b,k,w,z,E,S,I,j,B,x;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=p[f],a=n.toUpperCase(),u="EN-".concat(a),l=r.items.find(function(e){return e.name.toUpperCase()===u}),d=!1,l){e.n=2;break}return(l=r.add(u)).getRange("A1:B1").values=[["EN",a]],e.n=1,t.sync();case 1:d=!0;case 2:if(g=[],m=new Set,e.p=3,!(y=l.getUsedRange())){e.n=5;break}return y.load("values,rowCount"),e.n=4,t.sync();case 4:if((g=y.values||[]).length>1)for(h=1;h<g.length;h++)(v=(g[h][0]||"").toString().trim().toLowerCase())&&m.add(v);case 5:e.n=7;break;case 6:e.p=6,e.v,console.log("Sheet ".concat(u," is new or empty"));case 7:b=[],k=c(i);try{for(k.s();!(w=k.n()).done;)(z=w.value)[n]&&""!==z[n].trim()&&(E=(z.en||"").toString().trim().toLowerCase())&&!m.has(E)&&(b.push([z.en,z[n]]),o++)}catch(e){k.e(e)}finally{k.f()}if(!(b.length>0)){e.n=9;break}return S=g.length>1?g.length+1:2,l.getRangeByIndexes(S-1,0,b.length,2).values=b,e.n=8,t.sync();case 8:O("‚úÖ Dodano ".concat(b.length," termin√≥w do ").concat(u)),e.n=10;break;case 9:if(d){O("üìã Utworzono arkusz ".concat(u," - sprawdzanie termin√≥w...")),I=0,j=c(i);try{for(j.s();!(B=j.n()).done;)(x=B.value)[n]&&""!==x[n].trim()&&I++}catch(e){j.e(e)}finally{j.f()}O(I>0?"‚ö†Ô∏è Znaleziono ".concat(I," termin√≥w z t≈Çumaczeniem ").concat(n.toUpperCase(),", ale wszystkie ju≈º istniejƒÖ w arkuszu."):"‚ÑπÔ∏è Brak termin√≥w z t≈Çumaczeniem ".concat(n.toUpperCase()," w glosariuszu."))}case 10:return e.a(2)}},e,null,[[3,6]])}),f=0,p=u;case 2:if(!(f<p.length)){e.n=4;break}return e.d(n(l()),3);case 3:f++,e.n=2;break;case 4:if(!(a.pl_en_terms&&a.pl_en_terms.length>0)){e.n=14;break}if(d="PL-EN",g=r.items.find(function(e){return e.name.toUpperCase()===d}),m=!1,g){e.n=6;break}return(g=r.add(d)).getRange("A1:B1").values=[["PL","EN"]],e.n=5,t.sync();case 5:m=!0;case 6:if(y=[],h=new Set,e.p=7,!(v=g.getUsedRange())){e.n=9;break}return v.load("values,rowCount"),e.n=8,t.sync();case 8:if((y=v.values||[]).length>1)for(b=1;b<y.length;b++)(k=(y[b][0]||"").toString().trim().toLowerCase())&&h.add(k);case 9:e.n=11;break;case 10:e.p=10,e.v,console.log("Sheet ".concat(d," is new or empty"));case 11:w=[],z=c(a.pl_en_terms);try{for(z.s();!(E=z.n()).done;)(S=E.value).pl&&S.en&&(I=S.pl.toString().trim().toLowerCase())&&!h.has(I)&&(w.push([S.pl,S.en]),o++)}catch(e){z.e(e)}finally{z.f()}if(!(w.length>0)){e.n=13;break}return j=y.length>1?y.length+1:2,g.getRangeByIndexes(j-1,0,w.length,2).values=w,e.n=12,t.sync();case 12:O("‚úÖ Dodano ".concat(w.length," termin√≥w do PL-EN")),e.n=14;break;case 13:m&&O("üìã Utworzono arkusz PL-EN");case 14:return e.a(2)}},e,null,[[7,10]])}));return function(n){return e.apply(this,arguments)}}());case 8:return e.n=9,A();case 9:if(O("‚úÖ Dodano ".concat(o," nowych termin√≥w do glosariuszy!")),!(o>0)){e.n=10;break}return O("Otwieranie arkuszy glosariuszy..."),e.n=10,R();case 10:e.n=12;break;case 11:e.p=11,i=e.v,O("‚ùå B≈ÇƒÖd: ".concat(i.message)),console.error(i);case 12:return e.a(2)}},e,null,[[3,11]])})),_.apply(this,arguments)}function D(){return M.apply(this,arguments)}function M(){return M=p(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=p(s().m(function e(n){var t,r,a,o,i,u,l,f,p,d,v,b,k,w,z,E,S,I,O,j,B,x,L,C,P,A,N,R,T,U,_,D;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return(t=n.workbook.worksheets).load("items/name"),e.n=1,n.sync();case 1:r={},a=new Set,o={},i={},u=new Set,l={},f=c(t.items),e.p=2,f.s();case 3:if((p=f.n()).done){e.n=20;break}if(d=p.value,!((v=d.name.toUpperCase()).startsWith("EN-")&&v.length>=5)){e.n=11;break}if(b=v.slice(3).trim(),k=$(b)){e.n=4;break}return e.a(3,19);case 4:return a.add(k),o[k]=d.name,(w=d.getUsedRange()).load("values,rowCount,columnCount"),e.n=5,n.sync();case 5:if(!((z=w.values||[]).length<2)){e.n=6;break}return e.a(3,19);case 6:if(E=z[0].map(function(e){return $(e)}),S=E.indexOf("EN"),I=E.indexOf(k),!(S<0||I<0)){e.n=7;break}return e.a(3,19);case 7:O=1;case 8:if(!(O<z.length)){e.n=11;break}if(j=(z[O][S]||"").toString().trim(),B=(z[O][I]||"").toString().trim(),j&&B){e.n=9;break}return e.a(3,10);case 9:r[j]||(r[j]={}),r[j][k]=B;case 10:O++,e.n=8;break;case 11:if(!(v.startsWith("PL-")&&v.length>=5)){e.n=19;break}if(x=v.slice(3).trim(),L=$(x)){e.n=12;break}return e.a(3,19);case 12:return u.add(L),l[L]=d.name,(C=d.getUsedRange()).load("values,rowCount,columnCount"),e.n=13,n.sync();case 13:if(!((P=C.values||[]).length<2)){e.n=14;break}return e.a(3,19);case 14:if(A=P[0].map(function(e){return $(e)}),N=A.indexOf("PL"),R=A.indexOf(L),!(N<0||R<0)){e.n=15;break}return e.a(3,19);case 15:T=1;case 16:if(!(T<P.length)){e.n=19;break}if(U=(P[T][N]||"").toString().trim(),_=(P[T][R]||"").toString().trim(),U&&_){e.n=17;break}return e.a(3,18);case 17:i[U]||(i[U]={}),i[U][L]=_;case 18:T++,e.n=16;break;case 19:e.n=3;break;case 20:e.n=22;break;case 21:e.p=21,D=e.v,f.e(D);case 22:return e.p=22,f.f(),e.f(22);case 23:g=r,y=Array.from(a).sort(),m=i,h=Array.from(u).sort();case 24:return e.a(2)}},e,null,[[2,21,22,23]])}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2,g)}},e)})),M.apply(this,arguments)}function K(){return G.apply(this,arguments)}function G(){return G=p(s().m(function e(){var n,t,r,a,o,c,i;return s().w(function(e){for(;;)switch(e.n){case 0:if(n=$(document.getElementById("gLangSelect").value),t=document.getElementById("gNewLang").value.trim(),r=$(t),a=document.getElementById("sourceLangSelect").value||"EN",o=document.getElementById("gEn").value.trim(),c=document.getElementById("gTr").value.trim(),i=r||n){e.n=1;break}return O("Wybierz jƒôzyk z listy albo wpisz nowy (np. PL lub EN)."),e.a(2);case 1:if(o&&c){e.n=2;break}return O("Uzupe≈Çnij frazƒô ".concat(a," i t≈Çumaczenie.")),e.a(2);case 2:return e.n=3,Excel.run(function(){var e=p(s().m(function e(n){var t,r,u,l,f,p,d,g,m,y,h,v,b,k,w;return s().w(function(e){for(;;)switch(e.n){case 0:return(t=n.workbook.worksheets).load("items/name"),e.n=1,n.sync();case 1:if(r="".concat(a,"-").concat(i),!(l=t.items.find(function(e){return e.name.toUpperCase()===r}))){e.n=2;break}u=l,e.n=3;break;case 2:return(u=t.add(r)).getRange("A1:B1").values=[[a,i]],e.n=3,n.sync();case 3:return(f=u.getUsedRange()).load("values,rowCount"),e.n=4,n.sync();case 4:if(p=f.values||[],d=p[0].map(function(e){return $(e)}),g=d.indexOf(a),m=d.indexOf(i),!(g<0||m<0)){e.n=5;break}return O("B≈ÅƒÑD: Arkusz ".concat(r," musi mieƒá nag≈Ç√≥wki ").concat(a," oraz ").concat(i," w wierszu 1.")),e.a(2);case 5:y=-1,h=1;case 6:if(!(h<p.length)){e.n=8;break}if((p[h][g]||"").toString().trim().toLowerCase()!==o.toLowerCase()){e.n=7;break}return y=h+1,e.a(3,8);case 7:h++,e.n=6;break;case 8:return y>0?(v=X(m+1),u.getRange("".concat(v).concat(y)).values=[[c]]):(b=p.length+1,k=X(g+1),w=X(m+1),u.getRange("".concat(k).concat(b)).values=[[o]],u.getRange("".concat(w).concat(b)).values=[[c]]),e.n=9,n.sync();case 9:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 3:return e.n=4,A();case 4:document.getElementById("gEn").value="",document.getElementById("gTr").value="",document.getElementById("gNewLang").value="",O("Zapisano glosariusz: ".concat(termEN," -> ").concat(i,":").concat(c));case 5:return e.a(2)}},e)})),G.apply(this,arguments)}function W(){var e=document.getElementById("gList");if(e){for(var n="PL"===(document.getElementById("sourceLangSelect").value||"EN")?m||{}:g||{},t=$(document.getElementById("gLangSelect").value),r=[],a=0,o=Object.keys(n);a<o.length;a++){var c=o[a],i=n[c]||{};if(t)i[t]&&r.push("".concat(c,"  ‚Üí  ").concat(i[t]));else for(var u=0,s=Object.keys(i);u<s.length;u++){var l=s[u];r.push("".concat(c,"  |  ").concat(l,"  ‚Üí  ").concat(i[l]))}}e.textContent=r.length?r.join("\n"):"(brak wpis√≥w dla tego jƒôzyka)"}}function F(e,n,t){var r={},a=Object.keys(t||{}).sort(function(e,n){return n.length-e.length});if(!t||Object.keys(t).length===0){console.log("[GLOSSARY DEBUG] Empty glossary!")}else{console.log("[GLOSSARY DEBUG] Glossary has",Object.keys(t).length,"keys. First 10:",Object.keys(t).slice(0,10))}return{tokenizedLines:e.map(function(e){var o=e.split(/(\s+|[.,;:!?()\[\]{}"\'\-\/\\]+)/),i=[];for(var u=0;u<o.length;u++){var s=o[u],l=!1;for(var f=0;f<a.length&&!l;f++){var p=a[f],d=t[p]?t[p][n]:null;if(d&&s.trim().toLowerCase()===p.trim().toLowerCase()){var g="[[G".concat(Object.keys(r).length+1,"]]");i.push(g),r[g]=d,l=!0,console.log("[GLOSSARY DEBUG] Matched token:",s,"->",d,"(key:",p,")")}}l||i.push(s)}return i.join("")}),tokenMap:r}}function H(e,n){for(var t=e,r=0,a=Object.keys(n);r<a.length;r++){var o=a[r];t=t.split(o).join(n[o])}return t}function $(e){return(null!=e?e:"").toString().replace(/\u00A0/g," ").trim().toUpperCase()}function Z(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function X(e){for(var n="";e>0;){var t=(e-1)%26;n=String.fromCharCode(65+t)+n,e=Math.floor((e-1)/26)}return n}Office.onReady(function(){var e=p(s().m(function e(n){return s().w(function(e){for(;;)switch(e.n){case 0:if(n.host===Office.HostType.Excel){e.n=1;break}return e.a(2);case 1:return document.getElementById("runBtn").onclick=x,document.getElementById("gReloadBtn").onclick=p(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,A();case 1:O("Glosariusz od≈õwie≈ºony.");case 2:return e.a(2)}},e)})),document.getElementById("gAddBtn").onclick=K,document.getElementById("gLangSelect").onchange=function(){W()},document.getElementById("sourceLangSelect").onchange=function(){var e;B(),W(),e=document.getElementById("sourceLangSelect").value||"EN",document.getElementById("gEn").placeholder="PL"===e?"Fraza PL (np. grza≈Çka)":"Fraza EN (np. heating element)"},document.getElementById("gLoadBasicBtn").onclick=U,document.getElementById("gShowSheetsBtn").onclick=R,document.getElementById("saveApiKeyBtn").onclick=w,document.getElementById("clearApiKeyBtn").onclick=E,I(),e.n=2,A();case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}())}(),function(){"use strict";new URL(t(58394),t.b),new URL(t(98362),t.b),new URL(t(60947),t.b)}()}();
//# sourceMappingURL=taskpane.js.map