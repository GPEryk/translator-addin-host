{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/* global Office, Excel */\n// Force rebuild - version 2.0 with PL-EN support\n\n// API key bƒôdzie pobierany z localStorage przez ka≈ºdego u≈ºytkownika osobno\n// Bezpo≈õrednie po≈ÇƒÖczenie z OpenAI (bez proxy - najszybsze)\nconst OPENAI_API_URL = \"https://api.openai.com/v1/chat/completions\";\nconst MODEL = \"gpt-4o-mini\";\nconst MAX_RETRIES = 3; // Liczba pr√≥b w przypadku b≈Çƒôdu\nconst RETRY_DELAY = 2000; // 2 sekundy miƒôdzy pr√≥bami\n\nconst HEADER_ROW = 1;\nconst BATCH_SIZE = 80;\n\nlet glossaryCache = null;         // termEN -> { LANG: TR } (dla EN jako ≈∫r√≥d≈Ço)\nlet plGlossaryCache = null;       // termPL -> { LANG: TR } (dla PL jako ≈∫r√≥d≈Ço)\nlet availableLangs = [];          // [\"DE\",\"CZ\",\"PL\"...] (dostƒôpne dla EN)\nlet plAvailableLangs = [];        // [\"EN\"...] (dostƒôpne dla PL)\nlet langToSheetMap = {};          // LANG -> \"EN-LANG\"\nlet plLangToSheetMap = {};        // LANG -> \"PL-LANG\"\n\n// ---------- Custom alert/confirm (Office.js doesn't support window.alert/confirm) ----------\nfunction customAlert(message) {\n  return new Promise((resolve) => {\n    const modal = document.getElementById(\"alertModal\");\n    const messageEl = document.getElementById(\"alertMessage\");\n    const okBtn = document.getElementById(\"alertOk\");\n\n    messageEl.textContent = message;\n    modal.classList.remove(\"hidden\");\n\n    const cleanup = () => {\n      modal.classList.add(\"hidden\");\n      okBtn.onclick = null;\n      resolve();\n    };\n\n    okBtn.onclick = () => cleanup();\n  });\n}\n\nfunction customConfirm(message) {\n  return new Promise((resolve) => {\n    const modal = document.getElementById(\"confirmModal\");\n    const messageEl = document.getElementById(\"confirmMessage\");\n    const yesBtn = document.getElementById(\"confirmYes\");\n    const noBtn = document.getElementById(\"confirmNo\");\n\n    messageEl.textContent = message;\n    modal.classList.remove(\"hidden\");\n\n    const cleanup = (result) => {\n      modal.classList.add(\"hidden\");\n      yesBtn.onclick = null;\n      noBtn.onclick = null;\n      resolve(result);\n    };\n\n    yesBtn.onclick = () => cleanup(true);\n    noBtn.onclick = () => cleanup(false);\n  });\n}\n\nOffice.onReady(async (info) => {\n  if (info.host !== Office.HostType.Excel) return;\n\n  // bind UI\n  document.getElementById(\"runBtn\").onclick = runTranslate;\n\n  document.getElementById(\"gReloadBtn\").onclick = async () => {\n    await refreshGlossaryAll();\n    log(\"Glosariusz od≈õwie≈ºony.\");\n  };\n\n  document.getElementById(\"gAddBtn\").onclick = addOrUpdateGlossaryPair;\n\n  // NEW: filtr listy po wybranym jƒôzyku\n  document.getElementById(\"gLangSelect\").onchange = () => {\n    renderGlossaryList();\n  };\n\n  // NEW: zmiana jƒôzyka ≈∫r√≥d≈Çowego -> zmie≈Ñ dostƒôpne jƒôzyki docelowe\n  document.getElementById(\"sourceLangSelect\").onchange = () => {\n    fillLangDropdown();\n    renderGlossaryList();\n    updateGlossaryPlaceholders();\n  };\n\n  // Load basic glossary\n  document.getElementById(\"gLoadBasicBtn\").onclick = loadBasicGlossary;\n  \n  // Show glossary sheets\n  document.getElementById(\"gShowSheetsBtn\").onclick = showGlossarySheets;\n\n  // API Key management\n  document.getElementById(\"saveApiKeyBtn\").onclick = saveApiKey;\n  document.getElementById(\"clearApiKeyBtn\").onclick = clearApiKey;\n\n  // Load and show API key status\n  updateApiKeyStatus();\n\n  await refreshGlossaryAll();\n});\n\n// ---------- API Key Management ----------\n// U≈ºywamy Office.context.roamingSettings zamiast localStorage (dzia≈Ça lepiej w Excel)\nfunction getApiKey() {\n  try {\n    // Pr√≥buj Office.context.roamingSettings (najlepsze dla Office Add-ins)\n    if (typeof Office !== \"undefined\" && Office.context && Office.context.roamingSettings) {\n      return Office.context.roamingSettings.get(\"openai_api_key\") || \"\";\n    }\n  } catch (e) {\n    console.log(\"roamingSettings not available, using localStorage\");\n  }\n  \n  // Fallback do localStorage\n  try {\n    return localStorage.getItem(\"openai_api_key\") || \"\";\n  } catch (e) {\n    console.error(\"Storage not available:\", e);\n    return \"\";\n  }\n}\n\nasync function saveApiKey() {\n  const input = document.getElementById(\"apiKeyInput\");\n  const key = input.value.trim();\n  \n  if (!key) {\n    await customAlert(\"Wklej sw√≥j klucz API!\");\n    return;\n  }\n  \n  if (!key.startsWith(\"sk-\")) {\n    await customAlert(\"Klucz API powinien zaczynaƒá siƒô od 'sk-'\");\n    return;\n  }\n  \n  try {\n    // Zapisz w Office.context.roamingSettings (preferowane)\n    if (typeof Office !== \"undefined\" && Office.context && Office.context.roamingSettings) {\n      Office.context.roamingSettings.set(\"openai_api_key\", key);\n      Office.context.roamingSettings.saveAsync((result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          log(\"‚úÖ Klucz API zapisany!\");\n        } else {\n          log(\"‚ö†Ô∏è B≈ÇƒÖd zapisu: \" + result.error.message);\n        }\n      });\n    } else {\n      // Fallback do localStorage\n      localStorage.setItem(\"openai_api_key\", key);\n      log(\"‚úÖ Klucz API zapisany (localStorage)!\");\n    }\n    \n    input.value = \"\";\n    input.type = \"password\";\n    updateApiKeyStatus();\n  } catch (e) {\n    await customAlert(\"B≈ÇƒÖd zapisu klucza: \" + e.message);\n    console.error(e);\n  }\n}\n\nasync function clearApiKey() {\n  const confirmed = await customConfirm(\"Czy na pewno chcesz usunƒÖƒá zapisany klucz API?\");\n  \n  if (confirmed) {\n    try {\n      // Usu≈Ñ z Office.context.roamingSettings\n      if (typeof Office !== \"undefined\" && Office.context && Office.context.roamingSettings) {\n        Office.context.roamingSettings.remove(\"openai_api_key\");\n        Office.context.roamingSettings.saveAsync();\n      }\n      \n      // Usu≈Ñ z localStorage\n      localStorage.removeItem(\"openai_api_key\");\n      \n      document.getElementById(\"apiKeyInput\").value = \"\";\n      updateApiKeyStatus();\n      log(\"üóëÔ∏è Klucz API usuniƒôty\");\n    } catch (e) {\n      await customAlert(\"B≈ÇƒÖd usuwania klucza: \" + e.message);\n      console.error(e);\n    }\n  }\n}\n\nfunction updateApiKeyStatus() {\n  const statusEl = document.getElementById(\"apiKeyStatus\");\n  const key = getApiKey();\n  \n  if (key) {\n    const masked = key.substring(0, 10) + \"...\" + key.substring(key.length - 4);\n    statusEl.innerHTML = `‚úÖ Klucz zapisany: <code>${masked}</code> | <a href=\"https://platform.openai.com/api-keys\" target=\"_blank\">Zmie≈Ñ klucz</a>`;\n    statusEl.style.color = \"#10a37f\";\n  } else {\n    statusEl.innerHTML = `‚ö†Ô∏è Brak klucza API! <a href=\"https://platform.openai.com/api-keys\" target=\"_blank\">Uzyskaj klucz tutaj</a>`;\n    statusEl.style.color = \"#ff6b6b\";\n  }\n}\n\n// ---------- UI helpers ----------\nfunction log(msg) {\n  const el = document.getElementById(\"log\");\n  if (!el) return;\n  el.textContent += msg + \"\\n\";\n  el.scrollTop = el.scrollHeight;\n}\n\nfunction setProgress(pct) {\n  const wrap = document.getElementById(\"progress\");\n  const bar = document.getElementById(\"progressBar\");\n  if (!wrap || !bar) return;\n\n  if (pct == null) {\n    wrap.classList.add(\"hidden\");\n    return;\n  }\n  wrap.classList.remove(\"hidden\");\n  bar.style.width = `${pct}%`;\n}\n\nfunction fillLangDropdown() {\n  const sel = document.getElementById(\"gLangSelect\");\n  const sourceLang = document.getElementById(\"sourceLangSelect\").value || \"EN\";\n  sel.innerHTML = \"\";\n\n  // Wybierz odpowiedniƒÖ listƒô jƒôzyk√≥w w zale≈ºno≈õci od ≈∫r√≥d≈Ça\n  const langs = sourceLang === \"PL\" ? plAvailableLangs : availableLangs;\n  const sheetPrefix = sourceLang === \"PL\" ? \"PL-XX\" : \"EN-XX\";\n\n  if (!langs.length) {\n    const opt = document.createElement(\"option\");\n    opt.value = \"\";\n    opt.textContent = `(brak arkuszy ${sheetPrefix})`;\n    sel.appendChild(opt);\n    return;\n  }\n\n  // opcja \"wszystkie\"\n  const optAll = document.createElement(\"option\");\n  optAll.value = \"\";\n  optAll.textContent = \"Wszystkie jƒôzyki\";\n  sel.appendChild(optAll);\n\n  for (const l of langs) {\n    const opt = document.createElement(\"option\");\n    opt.value = l;\n    opt.textContent = l;\n    sel.appendChild(opt);\n  }\n}\n\n// Aktualizuj placeholdery w sekcji glosariusza w zale≈ºno≈õci od jƒôzyka ≈∫r√≥d≈Çowego\nfunction updateGlossaryPlaceholders() {\n  const sourceLang = document.getElementById(\"sourceLangSelect\").value || \"EN\";\n  const gEnInput = document.getElementById(\"gEn\");\n  \n  if (sourceLang === \"PL\") {\n    gEnInput.placeholder = \"Fraza PL (np. grza≈Çka)\";\n  } else {\n    gEnInput.placeholder = \"Fraza EN (np. heating element)\";\n  }\n}\n\n// ---------- main translate ----------\nasync function runTranslate() {\n  const apiKey = getApiKey();\n  if (!apiKey) {\n    await customAlert(\"‚ö†Ô∏è Najpierw zapisz sw√≥j klucz OpenAI API w sekcji Konfiguracja!\");\n    return;\n  }\n\n  const skipFilled = document.getElementById(\"skipFilled\").checked;\n  const sourceLang = document.getElementById(\"sourceLangSelect\").value || \"EN\";\n\n  if (!glossaryCache) {\n    await refreshGlossaryAll();\n  }\n\n  log(`Czytam zaznaczenie... (≈∫r√≥d≈Ço: ${sourceLang})`);\n\n  await Excel.run(async (ctx) => {\n    const sheet = ctx.workbook.worksheets.getActiveWorksheet();\n    const sel = ctx.workbook.getSelectedRange();\n    sel.load([\"rowCount\", \"columnCount\", \"rowIndex\", \"columnIndex\"]);\n    await ctx.sync();\n\n    const used = sheet.getUsedRange();\n    used.load(\"columnCount\");\n    await ctx.sync();\n\n    // header row in main sheet\n    const headerRange = sheet.getRangeByIndexes(HEADER_ROW - 1, 0, 1, used.columnCount);\n    headerRange.load(\"values\");\n    await ctx.sync();\n\n    const header = headerRange.values[0].map(h => normalizeHeader(h));\n    \n    // Znajd≈∫ kolumnƒô ≈∫r√≥d≈ÇowƒÖ (EN lub PL)\n    const srcCol = header.indexOf(sourceLang);\n    if (srcCol < 0) {\n      log(`B≈ÅƒÑD: brak kolumny ${sourceLang} w wierszu nag≈Ç√≥wk√≥w (1).`);\n      return;\n    }\n\n    // Wybierz odpowiedni cache glosariusza\n    const currentGlossary = sourceLang === \"PL\" ? plGlossaryCache : glossaryCache;\n\n    // collect items from selection\n    const items = [];\n    for (let r = 0; r < sel.rowCount; r++) {\n      for (let c = 0; c < sel.columnCount; c++) {\n        const absRow = sel.rowIndex + r;\n        const absCol = sel.columnIndex + c;\n        const tgtLang = header[absCol];\n\n        const srcCell = sheet.getCell(absRow, srcCol);\n        const tgtCell = sheet.getCell(absRow, absCol);\n        srcCell.load(\"values\");\n        tgtCell.load(\"values\");\n\n        items.push({ absRow, absCol, tgtLang, srcCell, tgtCell });\n      }\n    }\n    await ctx.sync();\n\n    // group by language\n    const groups = new Map();\n    for (const it of items) {\n      const src = (it.srcCell.values[0][0] || \"\").toString().trim();\n      const tgt = (it.tgtCell.values[0][0] || \"\").toString().trim();\n\n      if (!src) continue;\n      if (skipFilled && tgt) continue;\n\n      // nie t≈Çumacz kolumny ≈∫r√≥d≈Çowej\n      if (it.tgtLang === sourceLang) continue;\n\n      if (!groups.has(it.tgtLang)) groups.set(it.tgtLang, []);\n      groups.get(it.tgtLang).push({ ...it, src });\n    }\n\n    let total = 0;\n    for (const arr of groups.values()) total += arr.length;\n\n    if (total === 0) {\n      log(\"Brak danych do t≈Çumaczenia.\");\n      return;\n    }\n\n    let done = 0;\n\n    // process each lang\n    for (const [lang, arr] of groups.entries()) {\n      if (!lang) continue;\n      log(`${sourceLang} ‚Üí ${lang}: ${arr.length} rekord√≥w`);\n\n      for (let i = 0; i < arr.length; i += BATCH_SIZE) {\n        const batch = arr.slice(i, i + BATCH_SIZE);\n        const lines = batch.map(x => x.src);\n\n        // apply glossary tokens (u≈ºyj odpowiedniego cache)\n        const { tokenizedLines, tokenMap } =\n          applyGlossaryTokens(lines, lang, currentGlossary);\n\n        log(`  batch ${Math.floor(i / BATCH_SIZE) + 1}: wysy≈Çam ${lines.length} linii`);\n        const translatedLines = await callOpenAI(lang, tokenizedLines, sourceLang);\n\n        // restore tokens + write to cells\n        for (let j = 0; j < batch.length; j++) {\n          const restored =\n            restoreGlossaryTokens(translatedLines[j] || \"\", tokenMap);\n          sheet.getCell(batch[j].absRow, batch[j].absCol).values = [[restored]];\n        }\n        await ctx.sync();\n\n        done += batch.length;\n        setProgress(Math.round((done / total) * 100));\n      }\n    }\n\n    setProgress(null);\n    log(\"Gotowe.\");\n  });\n}\n\n// ---------- OpenAI ----------\nasync function callOpenAI(lang, lines, sourceLang = \"EN\") {\n  // Dostosuj prompt do jƒôzyka ≈∫r√≥d≈Çowego\n  const sourceLangName = sourceLang === \"PL\" ? \"Polish\" : \"English\";\n  const sysPrompt =\n    `You are translating product names from ${sourceLangName}. Keep meaning 1:1. Preserve brands, model codes, numbers, units, punctuation, and casing. Do not add marketing words. Do not paraphrase. Return one translation per line in the same order. Output only translations. Do NOT translate or alter tokens like [[G1]], [[G2]]; keep them exactly.`;\n\n  const userPrompt =\n    `Translate from ${sourceLang} to ${lang}\\nTexts (one per line):\\n` + lines.join(\"\\n\");\n\n  const payload = {\n    model: MODEL,\n    messages: [\n      { role: \"system\", content: sysPrompt },\n      { role: \"user\", content: userPrompt }\n    ],\n    max_tokens: 2000,\n    temperature: 0.3\n  };\n\n  const apiKey = getApiKey();\n  if (!apiKey) {\n    throw new Error(\"Brak klucza API! Dodaj klucz w sekcji Konfiguracja.\");\n  }\n\n  // Retry logic - pr√≥buj MAX_RETRIES razy\n  let lastError = null;\n  \n  for (let attempt = 1; attempt <= MAX_RETRIES; attempt++) {\n    try {\n      log(`  Pr√≥ba ${attempt}/${MAX_RETRIES}...`);\n      \n      const r = await fetch(OPENAI_API_URL, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": `Bearer ${apiKey}`,\n          \"OpenAI-Organization\": \"\" // Opcjonalne\n        },\n        body: JSON.stringify(payload)\n      });\n\n      if (!r.ok) {\n        const errorText = await r.text();\n        throw new Error(`OpenAI API error: ${r.status} - ${errorText}`);\n      }\n\n      const json = await r.json();\n\n      // Prawid≈Çowa struktura odpowiedzi OpenAI\n      const text = json.choices?.[0]?.message?.content || \"\";\n      \n      return text.split(/\\r?\\n/);\n      \n    } catch (error) {\n      lastError = error;\n      log(`  ‚ö†Ô∏è B≈ÇƒÖd: ${error.message}`);\n      \n      // Je≈õli to nie ostatnia pr√≥ba, czekaj i spr√≥buj ponownie\n      if (attempt < MAX_RETRIES) {\n        log(`  Czekam ${RETRY_DELAY/1000}s przed kolejnƒÖ pr√≥bƒÖ...`);\n        await new Promise(resolve => setTimeout(resolve, RETRY_DELAY));\n      }\n    }\n  }\n  \n  // Wszystkie pr√≥by nieudane\n  throw new Error(`Nie uda≈Ço siƒô po≈ÇƒÖczyƒá z OpenAI po ${MAX_RETRIES} pr√≥bach. Sprawd≈∫:\\n1. Czy klucz API jest prawid≈Çowy\\n2. Czy masz ≈õrodki na koncie OpenAI\\n3. Spr√≥buj ponownie za chwilƒô\\n\\nOstatni b≈ÇƒÖd: ${lastError?.message}`);\n}\n\n// ---------- glossary refresh ----------\nasync function refreshGlossaryAll() {\n  await loadGlossaryFromAllSheets();\n  fillLangDropdown();\n  renderGlossaryList();\n}\n\n// ---------- Show glossary sheets ----------\nasync function showGlossarySheets() {\n  log(\"Otwieranie arkuszy glosariuszy...\");\n  \n  try {\n    await Excel.run(async (ctx) => {\n      const sheets = ctx.workbook.worksheets;\n      sheets.load(\"items/name\");\n      await ctx.sync();\n\n      // Find all EN-XX and PL-XX sheets\n      const glossarySheets = sheets.items.filter(s => {\n        const nameU = s.name.toUpperCase();\n        return (nameU.startsWith(\"EN-\") || nameU.startsWith(\"PL-\")) && nameU.length >= 5;\n      });\n\n      if (glossarySheets.length === 0) {\n        log(\"‚ö†Ô∏è Nie znaleziono arkuszy glosariuszy (EN-PL, PL-EN, EN-DE, itp.)\");\n        log(\"Stw√≥rz je najpierw u≈ºywajƒÖc 'Dodaj/zaktualizuj parƒô' lub 'Za≈Çaduj podstawowy glosariusz'\");\n        return;\n      }\n\n      // Activate first glossary sheet\n      glossarySheets[0].activate();\n      await ctx.sync();\n\n      // Log all found sheets\n      const sheetNames = glossarySheets.map(s => s.name).join(\", \");\n      log(`‚úÖ Znaleziono arkusze: ${sheetNames}`);\n      log(`üìã Aktywowano: ${glossarySheets[0].name}`);\n      log(\"üí° Mo≈ºesz prze≈ÇƒÖczaƒá siƒô miƒôdzy arkuszami u≈ºywajƒÖc zak≈Çadek na dole Excela\");\n      \n    });\n  } catch (error) {\n    log(`‚ùå B≈ÇƒÖd: ${error.message}`);\n    console.error(error);\n  }\n}\n\n// ---------- Load basic glossary ----------\nasync function loadBasicGlossary() {\n  const confirmed = await customConfirm(\n    \"Czy za≈Çadowaƒá podstawowy glosariusz?\\n\\nTo doda terminy techniczne do arkuszy:\\n‚Ä¢ EN ‚Üí PL, DE, FR, ES, IT, RO, UA, RU\\n‚Ä¢ PL ‚Üí EN (t≈Çumaczenie polsko-angielskie)\"\n  );\n  \n  if (!confirmed) {\n    return;\n  }\n\n  log(\"≈Åadowanie podstawowego glosariusza...\");\n\n  try {\n    // Fetch basic glossary JSON (with cache busting)\n    const timestamp = new Date().getTime();\n    const response = await fetch(`https://gperyk.github.io/translator-addin-host/glossary/basic-glossary.json?t=${timestamp}`);\n    \n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    \n    const data = await response.json();\n    \n    if (!data || !data.terms) {\n      throw new Error(\"Nieprawid≈Çowa struktura danych glosariusza. Spr√≥buj ponownie za chwilƒô.\");\n    }\n\n    let totalAdded = 0;\n\n    await Excel.run(async (ctx) => {\n      const sheets = ctx.workbook.worksheets;\n      sheets.load(\"items/name\");\n      await ctx.sync();\n\n      // Get all terms from JSON\n      const allTerms = data.terms;\n\n      // ===== EN-XX sheets (EN jako ≈∫r√≥d≈Ço) =====\n      const languages = [\"pl\", \"de\", \"fr\", \"es\", \"it\", \"ro\", \"ua\", \"ru\"];\n      \n      for (const lang of languages) {\n        const langUpper = lang.toUpperCase();\n        const sheetName = `EN-${langUpper}`;\n        \n        // Find or create sheet\n        let sheet = sheets.items.find(s => s.name.toUpperCase() === sheetName);\n        let isNewSheet = false;\n        if (!sheet) {\n          sheet = sheets.add(sheetName);\n          sheet.getRange(\"A1:B1\").values = [[\"EN\", langUpper]];\n          await ctx.sync();\n          isNewSheet = true;\n        }\n\n        // Get existing data\n        let existingData = [];\n        let existingTerms = new Set();\n        \n        try {\n          const used = sheet.getUsedRange();\n          if (used) {\n            used.load(\"values,rowCount\");\n            await ctx.sync();\n            existingData = used.values || [];\n            \n            // If sheet has data (more than just header)\n            if (existingData.length > 1) {\n              for (let i = 1; i < existingData.length; i++) {\n                const en = (existingData[i][0] || \"\").toString().trim().toLowerCase();\n                if (en) existingTerms.add(en);\n              }\n            }\n          }\n        } catch (e) {\n          // Sheet is empty or new, that's OK\n          console.log(`Sheet ${sheetName} is new or empty`);\n        }\n\n        // Add new terms\n        const termsToAdd = [];\n        for (const term of allTerms) {\n          // Check if term has translation for this language\n          if (term[lang] && term[lang].trim() !== \"\") {\n            const enLower = (term.en || \"\").toString().trim().toLowerCase();\n            if (enLower && !existingTerms.has(enLower)) {\n              termsToAdd.push([term.en, term[lang]]);\n              totalAdded++;\n            }\n          }\n        }\n\n        if (termsToAdd.length > 0) {\n          // Calculate start row: if sheet has only header (1 row), start at row 2\n          const startRow = existingData.length > 1 ? existingData.length + 1 : 2;\n          const range = sheet.getRangeByIndexes(startRow - 1, 0, termsToAdd.length, 2);\n          range.values = termsToAdd;\n          await ctx.sync();\n          log(`‚úÖ Dodano ${termsToAdd.length} termin√≥w do ${sheetName}`);\n        } else {\n          // Log what happened\n          if (isNewSheet) {\n            log(`üìã Utworzono arkusz ${sheetName} - sprawdzanie termin√≥w...`);\n            // Count how many terms have this language\n            let termsWithLang = 0;\n            for (const term of allTerms) {\n              if (term[lang] && term[lang].trim() !== \"\") termsWithLang++;\n            }\n            if (termsWithLang > 0) {\n              log(`‚ö†Ô∏è Znaleziono ${termsWithLang} termin√≥w z t≈Çumaczeniem ${lang.toUpperCase()}, ale wszystkie ju≈º istniejƒÖ w arkuszu.`);\n            } else {\n              log(`‚ÑπÔ∏è Brak termin√≥w z t≈Çumaczeniem ${lang.toUpperCase()} w glosariuszu.`);\n            }\n          }\n        }\n      }\n\n      // ===== PL-EN sheet (PL jako ≈∫r√≥d≈Ço) =====\n      if (data.pl_en_terms && data.pl_en_terms.length > 0) {\n        const plEnSheetName = \"PL-EN\";\n        \n        // Find or create PL-EN sheet\n        let plEnSheet = sheets.items.find(s => s.name.toUpperCase() === plEnSheetName);\n        let isNewPlEnSheet = false;\n        if (!plEnSheet) {\n          plEnSheet = sheets.add(plEnSheetName);\n          plEnSheet.getRange(\"A1:B1\").values = [[\"PL\", \"EN\"]];\n          await ctx.sync();\n          isNewPlEnSheet = true;\n        }\n\n        // Get existing data\n        let existingPlData = [];\n        let existingPlTerms = new Set();\n        \n        try {\n          const usedPl = plEnSheet.getUsedRange();\n          if (usedPl) {\n            usedPl.load(\"values,rowCount\");\n            await ctx.sync();\n            existingPlData = usedPl.values || [];\n            \n            if (existingPlData.length > 1) {\n              for (let i = 1; i < existingPlData.length; i++) {\n                const pl = (existingPlData[i][0] || \"\").toString().trim().toLowerCase();\n                if (pl) existingPlTerms.add(pl);\n              }\n            }\n          }\n        } catch (e) {\n          console.log(`Sheet ${plEnSheetName} is new or empty`);\n        }\n\n        // Add new PL-EN terms\n        const plEnTermsToAdd = [];\n        for (const term of data.pl_en_terms) {\n          if (term.pl && term.en) {\n            const plLower = term.pl.toString().trim().toLowerCase();\n            if (plLower && !existingPlTerms.has(plLower)) {\n              plEnTermsToAdd.push([term.pl, term.en]);\n              totalAdded++;\n            }\n          }\n        }\n\n        if (plEnTermsToAdd.length > 0) {\n          const startRow = existingPlData.length > 1 ? existingPlData.length + 1 : 2;\n          const range = plEnSheet.getRangeByIndexes(startRow - 1, 0, plEnTermsToAdd.length, 2);\n          range.values = plEnTermsToAdd;\n          await ctx.sync();\n          log(`‚úÖ Dodano ${plEnTermsToAdd.length} termin√≥w do PL-EN`);\n        } else if (isNewPlEnSheet) {\n          log(`üìã Utworzono arkusz PL-EN`);\n        }\n      }\n    });\n\n    await refreshGlossaryAll();\n    log(`‚úÖ Dodano ${totalAdded} nowych termin√≥w do glosariuszy!`);\n    \n    // Automatically show glossary sheets after loading\n    if (totalAdded > 0) {\n      log(\"Otwieranie arkuszy glosariuszy...\");\n      await showGlossarySheets();\n    }\n    \n  } catch (error) {\n    log(`‚ùå B≈ÇƒÖd: ${error.message}`);\n    console.error(error);\n  }\n}\n\n// ---------- glossary from EN-XX and PL-XX sheets ----------\nasync function loadGlossaryFromAllSheets() {\n  await Excel.run(async (ctx) => {\n    const sheets = ctx.workbook.worksheets;\n    sheets.load(\"items/name\");\n    await ctx.sync();\n\n    // EN-XX glossaries (EN jako ≈∫r√≥d≈Ço)\n    const enMap = {};              // termEN -> { LANG: translation }\n    const enLangsSet = new Set();\n    const enL2s = {};\n\n    // PL-XX glossaries (PL jako ≈∫r√≥d≈Ço)\n    const plMap = {};              // termPL -> { LANG: translation }\n    const plLangsSet = new Set();\n    const plL2s = {};\n\n    for (const sh of sheets.items) {\n      const nameU = sh.name.toUpperCase();\n\n      // EN-DE / EN-CZ / EN-RO / EN-PL ...\n      if (nameU.startsWith(\"EN-\") && nameU.length >= 5) {\n        const tgtLangRaw = nameU.slice(3).trim();\n        const tgtLang = normalizeHeader(tgtLangRaw);\n        if (!tgtLang) continue;\n\n        enLangsSet.add(tgtLang);\n        enL2s[tgtLang] = sh.name;\n\n        const used = sh.getUsedRange();\n        used.load(\"values,rowCount,columnCount\");\n        await ctx.sync();\n\n        const vals = used.values || [];\n        if (vals.length < 2) continue;\n\n        const hdr = vals[0].map(h => normalizeHeader(h));\n        const enIx = hdr.indexOf(\"EN\");\n        const tgtIx = hdr.indexOf(tgtLang);\n\n        if (enIx < 0 || tgtIx < 0) continue;\n\n        for (let r = 1; r < vals.length; r++) {\n          const termEN = (vals[r][enIx] || \"\").toString().trim();\n          const tr = (vals[r][tgtIx] || \"\").toString().trim();\n          if (!termEN || !tr) continue;\n\n          if (!enMap[termEN]) enMap[termEN] = {};\n          enMap[termEN][tgtLang] = tr;\n        }\n      }\n\n      // PL-EN / PL-DE / PL-XX ...\n      if (nameU.startsWith(\"PL-\") && nameU.length >= 5) {\n        const tgtLangRaw = nameU.slice(3).trim();\n        const tgtLang = normalizeHeader(tgtLangRaw);\n        if (!tgtLang) continue;\n\n        plLangsSet.add(tgtLang);\n        plL2s[tgtLang] = sh.name;\n\n        const used = sh.getUsedRange();\n        used.load(\"values,rowCount,columnCount\");\n        await ctx.sync();\n\n        const vals = used.values || [];\n        if (vals.length < 2) continue;\n\n        const hdr = vals[0].map(h => normalizeHeader(h));\n        const plIx = hdr.indexOf(\"PL\");\n        const tgtIx = hdr.indexOf(tgtLang);\n\n        if (plIx < 0 || tgtIx < 0) continue;\n\n        for (let r = 1; r < vals.length; r++) {\n          const termPL = (vals[r][plIx] || \"\").toString().trim();\n          const tr = (vals[r][tgtIx] || \"\").toString().trim();\n          if (!termPL || !tr) continue;\n\n          if (!plMap[termPL]) plMap[termPL] = {};\n          plMap[termPL][tgtLang] = tr;\n        }\n      }\n    }\n\n    // Zapisz cache dla EN jako ≈∫r√≥d≈Ço\n    glossaryCache = enMap;\n    availableLangs = Array.from(enLangsSet).sort();\n    langToSheetMap = enL2s;\n\n    // Zapisz cache dla PL jako ≈∫r√≥d≈Ço\n    plGlossaryCache = plMap;\n    plAvailableLangs = Array.from(plLangsSet).sort();\n    plLangToSheetMap = plL2s;\n  });\n\n  return glossaryCache;\n}\n\n// ---------- add/update glossary pair (and create EN-XX if needed) ----------\nasync function addOrUpdateGlossaryPair() {\n  const selLang = normalizeHeader(document.getElementById(\"gLangSelect\").value);\n  const newLangRaw = document.getElementById(\"gNewLang\").value.trim();\n  const newLang = normalizeHeader(newLangRaw);\n\n  const sourceLang = document.getElementById(\"sourceLangSelect\").value || \"EN\";\n  const termSource = document.getElementById(\"gEn\").value.trim();\n  const tr = document.getElementById(\"gTr\").value.trim();\n\n  const tgtLang = newLang || selLang;\n\n  if (!tgtLang) {\n    log(\"Wybierz jƒôzyk z listy albo wpisz nowy (np. PL lub EN).\");\n    return;\n  }\n  if (!termSource || !tr) {\n    log(`Uzupe≈Çnij frazƒô ${sourceLang} i t≈Çumaczenie.`);\n    return;\n  }\n\n  await Excel.run(async (ctx) => {\n    const sheets = ctx.workbook.worksheets;\n    sheets.load(\"items/name\");\n    await ctx.sync();\n\n    const sheetName = `${sourceLang}-${tgtLang}`;\n    let glossSheet;\n\n    // find or create XX-YY sheet\n    const existing = sheets.items.find(s => s.name.toUpperCase() === sheetName);\n    if (existing) {\n      glossSheet = existing;\n    } else {\n      glossSheet = sheets.add(sheetName);\n      glossSheet.getRange(\"A1:B1\").values = [[sourceLang, tgtLang]];\n      await ctx.sync();\n    }\n\n    const used = glossSheet.getUsedRange();\n    used.load(\"values,rowCount\");\n    await ctx.sync();\n\n    const vals = used.values || [];\n    const hdr = vals[0].map(h => normalizeHeader(h));\n    const srcIx = hdr.indexOf(sourceLang);\n    const tgtIx = hdr.indexOf(tgtLang);\n\n    if (srcIx < 0 || tgtIx < 0) {\n      log(`B≈ÅƒÑD: Arkusz ${sheetName} musi mieƒá nag≈Ç√≥wki ${sourceLang} oraz ${tgtLang} w wierszu 1.`);\n      return;\n    }\n\n    // search row to update\n    let foundRow = -1;\n    for (let r = 1; r < vals.length; r++) {\n      const src0 = (vals[r][srcIx] || \"\").toString().trim().toLowerCase();\n      if (src0 === termSource.toLowerCase()) {\n        foundRow = r + 1; // 1-based\n        break;\n      }\n    }\n\n    if (foundRow > 0) {\n      // update\n      const colLetter = indexToCol(tgtIx + 1);\n      glossSheet.getRange(`${colLetter}${foundRow}`).values = [[tr]];\n    } else {\n      // append\n      const nextRow = vals.length + 1;\n      const srcColLetter = indexToCol(srcIx + 1);\n      const tgtColLetter = indexToCol(tgtIx + 1);\n      glossSheet.getRange(`${srcColLetter}${nextRow}`).values = [[termSource]];\n      glossSheet.getRange(`${tgtColLetter}${nextRow}`).values = [[tr]];\n    }\n\n    await ctx.sync();\n  });\n\n  // refresh cache & UI\n  await refreshGlossaryAll();\n\n  // clear inputs except lang\n  document.getElementById(\"gEn\").value = \"\";\n  document.getElementById(\"gTr\").value = \"\";\n  document.getElementById(\"gNewLang\").value = \"\";\n\n  log(`Zapisano glosariusz: ${termEN} -> ${tgtLang}:${tr}`);\n}\n\n// ---------- glossary list (FILTERED BY DROPDOWN) ----------\nfunction renderGlossaryList() {\n  const el = document.getElementById(\"gList\");\n  if (!el) return;\n\n  // Wybierz odpowiedni cache w zale≈ºno≈õci od jƒôzyka ≈∫r√≥d≈Çowego\n  const sourceLang = document.getElementById(\"sourceLangSelect\").value || \"EN\";\n  const map = sourceLang === \"PL\" ? (plGlossaryCache || {}) : (glossaryCache || {});\n  \n  const selectedLang = normalizeHeader(\n    document.getElementById(\"gLangSelect\").value\n  );\n\n  const lines = [];\n\n  for (const term of Object.keys(map)) {\n    const langsObj = map[term] || {};\n\n    if (!selectedLang) {\n      // pokaz wszystko\n      for (const lang of Object.keys(langsObj)) {\n        lines.push(`${term}  |  ${lang}  ‚Üí  ${langsObj[lang]}`);\n      }\n    } else {\n      // filtr po wybranym jƒôzyku\n      if (langsObj[selectedLang]) {\n        lines.push(`${term}  ‚Üí  ${langsObj[selectedLang]}`);\n      }\n    }\n  }\n\n  el.textContent = lines.length\n    ? lines.join(\"\\n\")\n    : \"(brak wpis√≥w dla tego jƒôzyka)\";\n}\n\n// ---------- glossary tokenization (whole word/phrase only) ----------\nfunction applyGlossaryTokens(lines, tgtLang, glossaryMap) {\n  const tokenMap = {}; // token -> translation\n  const terms = Object.keys(glossaryMap || {}).sort((a,b)=>b.length-a.length);\n\n  const tokenizedLines = lines.map(line => {\n    let out = line;\n\n    for (const term of terms) {\n      const tr = glossaryMap[term]?.[tgtLang];\n      if (!tr) continue;\n\n      const token = `[[G${Object.keys(tokenMap).length + 1}]]`;\n\n      const safe = escapeRegex(term);\n      const re = new RegExp(`\\\\b${safe}\\\\b`, \"gi\"); // only whole word/phrase\n      out = out.replace(re, token);\n\n      tokenMap[token] = tr;\n    }\n    return out;\n  });\n\n  return { tokenizedLines, tokenMap };\n}\n\nfunction restoreGlossaryTokens(line, tokenMap) {\n  let out = line;\n  for (const token of Object.keys(tokenMap)) {\n    out = out.split(token).join(tokenMap[token]);\n  }\n  return out;\n}\n\n// ---------- utils ----------\nfunction normalizeHeader(v) {\n  return (v ?? \"\").toString().replace(/\\u00A0/g, \" \").trim().toUpperCase();\n}\n\nfunction escapeRegex(s) {\n  return s.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\n\n// 1-based column index -> Excel letters\nfunction indexToCol(n) {\n  let s = \"\";\n  while (n > 0) {\n    let m = (n - 1) % 26;\n    s = String.fromCharCode(65 + m) + s;\n    n = Math.floor((n - 1) / 26);\n  }\n  return s;\n}","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/logo-filled.png\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_2___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"/> <title>T≈Çumacz GP</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\"/> </head> <body> <div class=\\\"app\\\"> <header class=\\\"app-header\\\"> <img src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"GASTROPARTS\\\" class=\\\"logo-img\\\"/> <div> <div class=\\\"title\\\">GASTROPARTS Translator</div> <div class=\\\"subtitle\\\">T≈Çumaczenie EN‚ÜîPL z glossariuszami technicznymi</div> </div> </header> <section class=\\\"card config-card\\\"> <div class=\\\"card-title\\\">‚öôÔ∏è Konfiguracja API</div> <div class=\\\"row\\\"> <input id=\\\"apiKeyInput\\\" type=\\\"password\\\" class=\\\"input\\\" placeholder=\\\"Wklej sw√≥j klucz OpenAI API (sk-proj-...)\\\"/> </div> <div class=\\\"row actions\\\"> <button id=\\\"saveApiKeyBtn\\\" class=\\\"btn btn-primary\\\">Zapisz klucz</button> <button id=\\\"clearApiKeyBtn\\\" class=\\\"btn btn-ghost\\\">Wyczy≈õƒá</button> </div> <div class=\\\"hint\\\" id=\\\"apiKeyStatus\\\"> ‚ÑπÔ∏è Klucz API zapisze siƒô tylko na tym komputerze. <a href=\\\"https://platform.openai.com/api-keys\\\" target=\\\"_blank\\\">Uzyskaj klucz tutaj</a> </div> </section> <section class=\\\"card\\\"> <div class=\\\"row\\\" style=\\\"margin-bottom:12px;align-items:center\\\"> <label style=\\\"font-size:13px;font-weight:600;color:#333;margin-right:8px\\\">Kierunek t≈Çumaczenia:</label> <select id=\\\"sourceLangSelect\\\" class=\\\"input\\\" style=\\\"width:auto;min-width:120px;flex:0\\\"> <option value=\\\"EN\\\" selected=\\\"selected\\\">EN ‚Üí inne jƒôzyki</option> <option value=\\\"PL\\\">PL ‚Üí EN</option> </select> </div> <button id=\\\"runBtn\\\" class=\\\"btn btn-primary\\\">üåê T≈Çumacz zaznaczenie</button> <label class=\\\"check\\\"> <input type=\\\"checkbox\\\" id=\\\"skipFilled\\\"/> Pomijaj, je≈õli kom√≥rka docelowa jest ju≈º wype≈Çniona </label> <div id=\\\"progress\\\" class=\\\"progress hidden\\\"> <div id=\\\"progressBar\\\" class=\\\"progress-bar\\\"></div> </div> <pre id=\\\"log\\\" class=\\\"log\\\"></pre> </section> <section class=\\\"card\\\"> <div class=\\\"card-title\\\">üìö ZarzƒÖdzanie glosariuszem</div> <div class=\\\"row two\\\"> <select id=\\\"gLangSelect\\\" class=\\\"input\\\"></select> <input id=\\\"gNewLang\\\" class=\\\"input\\\" placeholder=\\\"Dodaj nowy jƒôzyk (np. EN, DE, CZ...)\\\"/> </div> <div class=\\\"row\\\"> <input id=\\\"gEn\\\" class=\\\"input\\\" placeholder=\\\"Fraza ≈∫r√≥d≈Çowa (np. heating element)\\\"/> </div> <div class=\\\"row\\\"> <input id=\\\"gTr\\\" class=\\\"input\\\" placeholder=\\\"T≈Çumaczenie dla wybranego jƒôzyka\\\"/> </div> <div class=\\\"row actions\\\"> <button id=\\\"gAddBtn\\\" class=\\\"btn\\\">Dodaj / zaktualizuj parƒô</button> <button id=\\\"gReloadBtn\\\" class=\\\"btn btn-ghost\\\">Od≈õwie≈º glosariusz</button> </div> <div class=\\\"row actions\\\"> <button id=\\\"gLoadBasicBtn\\\" class=\\\"btn\\\" style=\\\"background:linear-gradient(135deg,#10a37f,#0ea57a);color:#fff;border:none\\\">üìö Za≈Çaduj podstawowy glosariusz</button> <button id=\\\"gShowSheetsBtn\\\" class=\\\"btn btn-ghost\\\">üìã Otw√≥rz arkusze glosariuszy</button> </div> <div id=\\\"gList\\\" class=\\\"glist\\\">(wczytywanie...)</div> <div class=\\\"hint\\\"> <b>üìã Format arkuszy glosariuszy:</b><br/> ‚Ä¢ <b>EN-PL</b>, <b>EN-DE</b>, <b>EN-FR</b> (EN ‚Üí inne jƒôzyki)<br/> ‚Ä¢ <b>PL-EN</b> (PL ‚Üí EN)<br/> Wiersz 1 = nag≈Ç√≥wki (jƒôzyki ≈∫r√≥d≈Çowy i docelowy)<br/> Kolejne wiersze = pary termin√≥w do t≈Çumaczenia </div> </section> </div> <div id=\\\"confirmModal\\\" class=\\\"modal hidden\\\"> <div class=\\\"modal-content\\\"> <div class=\\\"modal-title\\\">Potwierdzenie</div> <div id=\\\"confirmMessage\\\" class=\\\"modal-message\\\"></div> <div class=\\\"modal-actions\\\"> <button id=\\\"confirmYes\\\" class=\\\"btn btn-primary\\\">Tak</button> <button id=\\\"confirmNo\\\" class=\\\"btn btn-ghost\\\">Nie</button> </div> </div> </div> <div id=\\\"alertModal\\\" class=\\\"modal hidden\\\"> <div class=\\\"modal-content\\\"> <div class=\\\"modal-title\\\">Informacja</div> <div id=\\\"alertMessage\\\" class=\\\"modal-message\\\"></div> <div class=\\\"modal-actions\\\"> <button id=\\\"alertOk\\\" class=\\\"btn btn-primary\\\">OK</button> </div> </div> </div> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_2___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","glossaryCache","plGlossaryCache","availableLangs","plAvailableLangs","customAlert","message","modal","getElementById","messageEl","okBtn","textContent","classList","remove","onclick","add","customConfirm","yesBtn","noBtn","cleanup","result","getApiKey","Office","context","roamingSettings","get","console","log","localStorage","getItem","error","saveApiKey","_saveApiKey","_callee3","input","key","_t","_context3","trim","startsWith","set","saveAsync","status","AsyncResultStatus","Succeeded","setItem","type","updateApiKeyStatus","clearApiKey","_clearApiKey","_callee4","_t2","_context4","removeItem","statusEl","masked","substring","innerHTML","concat","style","color","msg","el","scrollTop","scrollHeight","setProgress","pct","wrap","bar","width","fillLangDropdown","sel","sourceLang","langs","sheetPrefix","opt","createElement","appendChild","optAll","_step","_iterator","_createForOfIteratorHelper","s","err","runTranslate","_runTranslate","_callee6","skipFilled","_context6","checked","refreshGlossaryAll","Excel","run","_ref3","_callee5","ctx","sheet","used","headerRange","header","srcCol","currentGlossary","items","absRow","absCol","tgtLang","srcCell","tgtCell","groups","_i4","_items","it","tgt","total","_iterator3","_step3","arr","_iterator4","_step4","_step4$value","lang","_arr","batch","lines","_applyGlossaryTokens","tokenizedLines","tokenMap","translatedLines","j","restored","_t3","_context5","workbook","worksheets","getActiveWorksheet","getSelectedRange","load","sync","getUsedRange","getRangeByIndexes","HEADER_ROW","columnCount","values","map","h","normalizeHeader","indexOf","rowCount","rowIndex","columnIndex","getCell","push","Map","toString","has","_objectSpread","entries","_slicedToArray","slice","x","applyGlossaryTokens","Math","floor","callOpenAI","restoreGlossaryTokens","round","_x4","_x2","_x3","_callOpenAI","_callee7","_lastError","sysPrompt","userPrompt","payload","apiKey","lastError","attempt","_json$choices","errorText","json","text","_t4","_args7","_context7","join","model","messages","role","content","max_tokens","temperature","fetch","method","headers","body","JSON","stringify","ok","choices","split","RETRY_DELAY","setTimeout","_refreshGlossaryAll","_callee8","_context8","loadGlossaryFromAllSheets","renderGlossaryList","showGlossarySheets","_showGlossarySheets","_callee0","_t5","_context0","_ref4","_callee9","sheets","glossarySheets","sheetNames","_context9","filter","nameU","name","activate","_x5","loadBasicGlossary","_loadBasicGlossary","_callee10","timestamp","response","data","totalAdded","_t8","_context11","Date","getTime","terms","_ref5","_callee1","allTerms","languages","_loop","_i5","_languages","plEnSheetName","plEnSheet","isNewPlEnSheet","existingPlData","existingPlTerms","usedPl","pl","plEnTermsToAdd","_iterator7","_step7","term","plLower","startRow","_context10","langUpper","sheetName","isNewSheet","existingData","existingTerms","en","termsToAdd","_iterator5","_step5","_term","enLower","termsWithLang","_iterator6","_step6","_context1","find","getRange","Set","toLowerCase","_regeneratorValues","pl_en_terms","_x6","_loadGlossaryFromAllSheets","_callee12","_context13","_ref6","_callee11","enMap","enLangsSet","enL2s","plMap","plLangsSet","plL2s","_iterator8","_step8","sh","tgtLangRaw","vals","hdr","enIx","tgtIx","_termEN","tr","_tgtLangRaw","_tgtLang","_used","_vals","_hdr","plIx","_tgtIx","_r","termPL","_tr","_t9","_context12","termEN","Array","from","sort","_x7","addOrUpdateGlossaryPair","_addOrUpdateGlossaryPair","_callee14","selLang","newLangRaw","newLang","termSource","_context15","_ref7","_callee13","glossSheet","existing","srcIx","foundRow","colLetter","nextRow","srcColLetter","tgtColLetter","_context14","indexToCol","_x8","selectedLang","_i","_Object$keys","keys","langsObj","_i2","_Object$keys2","glossaryMap","line","_step2","out","_iterator2","_glossaryMap$term","token","safe","escapeRegex","re","RegExp","_i3","_Object$keys3","String","fromCharCode","onReady","_ref","_callee2","info","_context2","host","HostType","_callee","_context","onchange","placeholder","_x","URL"],"ignoreList":[],"sourceRoot":""}